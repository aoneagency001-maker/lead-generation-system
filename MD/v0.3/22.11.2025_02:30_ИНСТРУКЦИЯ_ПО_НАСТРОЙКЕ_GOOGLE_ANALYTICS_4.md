# –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø–æ –Ω–∞—Å—Ç—Ä–æ–π–∫–µ Google Analytics 4 –¥–ª—è –∞–≤—Ç–æ–Ω–æ–º–Ω–æ–π —Ä–∞–±–æ—Ç—ã

**–î–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è:** 22.11.2025 02:30

## üìã –°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ

1. [–û–±–∑–æ—Ä](#–æ–±–∑–æ—Ä)
2. [–ù–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –¥–∞–Ω–Ω—ã–µ](#–Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ-–¥–∞–Ω–Ω—ã–µ)
3. [–°–æ–∑–¥–∞–Ω–∏–µ Service Account](#—Å–æ–∑–¥–∞–Ω–∏–µ-service-account)
4. [–ü–æ–ª—É—á–µ–Ω–∏–µ Property ID](#–ø–æ–ª—É—á–µ–Ω–∏–µ-property-id)
5. [–ù–∞—Å—Ç—Ä–æ–π–∫–∞ –¥–æ—Å—Ç—É–ø–∞](#–Ω–∞—Å—Ç—Ä–æ–π–∫–∞-–¥–æ—Å—Ç—É–ø–∞)
6. [–ù–∞—Å—Ç—Ä–æ–π–∫–∞ –¥–ª—è –∞–≤—Ç–æ–Ω–æ–º–Ω–æ–π —Ä–∞–±–æ—Ç—ã](#–Ω–∞—Å—Ç—Ä–æ–π–∫–∞-–¥–ª—è-–∞–≤—Ç–æ–Ω–æ–º–Ω–æ–π-—Ä–∞–±–æ—Ç—ã)
7. [–ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è](#–ø—Ä–æ–≤–µ—Ä–∫–∞-–ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è)
8. [–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å](#–±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å)

---

## üéØ –û–±–∑–æ—Ä

Google Analytics 4 –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç Data API v1 –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –¥–∞–Ω–Ω—ã–º–∏:

1. **Data API v1** - –ø–æ–ª—É—á–µ–Ω–∏–µ –æ—Ç—á–µ—Ç–æ–≤ –∏ –º–µ—Ç—Ä–∏–∫
2. **Real-time API** - –¥–∞–Ω–Ω—ã–µ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏ (–ø–æ—Å–ª–µ–¥–Ω–∏–µ 30 –º–∏–Ω—É—Ç)
3. **Admin API** - —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ Properties (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

–î–ª—è –∞–≤—Ç–æ–Ω–æ–º–Ω–æ–π —Ä–∞–±–æ—Ç—ã —Å–∏—Å—Ç–µ–º—ã –Ω–∞–º –ø–æ–Ω–∞–¥–æ–±—è—Ç—Å—è:
- **Service Account JSON —Ñ–∞–π–ª** - –¥–ª—è –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ —á–µ—Ä–µ–∑ Service Account
- **Property ID** - –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä –≤–∞—à–µ–≥–æ GA4 Property
- **–ü—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞** - Analytics Viewer —Ä–æ–ª—å –¥–ª—è Service Account

---

## üîë –ù–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –¥–∞–Ω–Ω—ã–µ

### 1. Service Account JSON —Ñ–∞–π–ª

**–ß—Ç–æ —ç—Ç–æ:** JSON —Ñ–∞–π–ª —Å credentials –¥–ª—è Service Account –≤ Google Cloud

**–§–æ—Ä–º–∞—Ç:** JSON —Ñ–∞–π–ª —Å –∫–ª—é—á–∞–º–∏:
```json
{
  "type": "service_account",
  "project_id": "your-project-id",
  "private_key_id": "...",
  "private_key": "-----BEGIN PRIVATE KEY-----\n...\n-----END PRIVATE KEY-----\n",
  "client_email": "service-account@project.iam.gserviceaccount.com",
  "client_id": "...",
  "auth_uri": "https://accounts.google.com/o/oauth2/auth",
  "token_uri": "https://oauth2.googleapis.com/token",
  "auth_provider_x509_cert_url": "https://www.googleapis.com/oauth2/v1/certs",
  "client_x509_cert_url": "..."
}
```

**–ì–¥–µ —Ö—Ä–∞–Ω–∏—Ç—å:** 
- –í —Ñ–∞–π–ª–µ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ (–Ω–∞–ø—Ä–∏–º–µ—Ä: `credentials/ga4-service-account.json`)
- –ü—É—Ç—å —É–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è –≤ `.env` –∫–∞–∫ `GOOGLE_ANALYTICS_CREDENTIALS_PATH`

**–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å:** 
- ‚ö†Ô∏è **–ù–ò–ö–û–ì–î–ê** –Ω–µ –∫–æ–º–º–∏—Ç—å—Ç–µ —ç—Ç–æ—Ç —Ñ–∞–π–ª –≤ Git!
- –î–æ–±–∞–≤—å—Ç–µ –≤ `.gitignore`: `credentials/*.json`
- –•—Ä–∞–Ω–∏—Ç–µ –≤ –±–µ–∑–æ–ø–∞—Å–Ω–æ–º –º–µ—Å—Ç–µ

### 2. Property ID

**–ß—Ç–æ —ç—Ç–æ:** –ò–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä –≤–∞—à–µ–≥–æ GA4 Property

**–§–æ—Ä–º–∞—Ç:** –ß–∏—Å–ª–æ (–Ω–∞–ø—Ä–∏–º–µ—Ä: `123456789`)

**–ì–¥–µ —Ö—Ä–∞–Ω–∏—Ç—å:** –í –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è `.env` –∫–∞–∫ `GOOGLE_ANALYTICS_PROPERTY_ID`

**–ö–∞–∫ –Ω–∞–π—Ç–∏:** 
- –í –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–µ GA4 ‚Üí –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä ‚Üí –ù–∞—Å—Ç—Ä–æ–π–∫–∏ Property ‚Üí ID Property
- –ò–ª–∏ –≤ URL: `https://analytics.google.com/analytics/web/#/p123456789/`

**–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ:** Property ID –æ–ø—Ü–∏–æ–Ω–∞–ª–µ–Ω, –µ—Å–ª–∏ –≤—ã —Ö–æ—Ç–∏—Ç–µ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–æ–ª—É—á–∞—Ç—å —Å–ø–∏—Å–æ–∫ Properties —á–µ—Ä–µ–∑ Admin API.

### 3. –ü—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞ (IAM Role)

**–ß—Ç–æ —ç—Ç–æ:** –†–æ–ª—å, –∫–æ—Ç–æ—Ä–∞—è –¥–∞–µ—Ç Service Account –¥–æ—Å—Ç—É–ø –∫ –¥–∞–Ω–Ω—ã–º GA4

**–ù–µ–æ–±—Ö–æ–¥–∏–º–∞—è —Ä–æ–ª—å:**
- `Viewer` (Analytics Viewer) - –¥–ª—è —á—Ç–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö
- –ò–ª–∏ `Analytics Viewer` - –µ—Å–ª–∏ –¥–æ—Å—Ç—É–ø–Ω–∞

**–ì–¥–µ –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞—Ç—å:** –í Google Cloud Console ‚Üí IAM & Admin ‚Üí Service Accounts

---

## üîê –°–æ–∑–¥–∞–Ω–∏–µ Service Account

### –®–∞–≥ 1: –°–æ–∑–¥–∞–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞ –≤ Google Cloud (–µ—Å–ª–∏ –Ω–µ—Ç)

1. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –Ω–∞ [https://console.cloud.google.com/](https://console.cloud.google.com/)
2. –í–æ–π–¥–∏—Ç–µ –≤ —Å–≤–æ–π Google –∞–∫–∫–∞—É–Ω—Ç
3. –ù–∞–∂–º–∏—Ç–µ **"–°–æ–∑–¥–∞—Ç—å –ø—Ä–æ–µ–∫—Ç"** –∏–ª–∏ –≤—ã–±–µ—Ä–∏—Ç–µ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π
4. –ó–∞–ø–æ–ª–Ω–∏—Ç–µ:
   - **–ù–∞–∑–≤–∞–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞:** `Lead Generation System` (–∏–ª–∏ –ª—é–±–æ–µ –¥—Ä—É–≥–æ–µ)
   - **–û—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏—è:** (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
5. –ù–∞–∂–º–∏—Ç–µ **"–°–æ–∑–¥–∞—Ç—å"**

### –®–∞–≥ 2: –í–∫–ª—é—á–µ–Ω–∏–µ Google Analytics Data API

1. –í Google Cloud Console –ø–µ—Ä–µ–π–¥–∏—Ç–µ –≤ **"APIs & Services" ‚Üí "Library"**
2. –ù–∞–π–¥–∏—Ç–µ **"Google Analytics Data API"**
3. –ù–∞–∂–º–∏—Ç–µ **"Enable"** (–í–∫–ª—é—á–∏—Ç—å)
4. –î–æ–∂–¥–∏—Ç–µ—Å—å –∞–∫—Ç–∏–≤–∞—Ü–∏–∏ (–æ–±—ã—á–Ω–æ –Ω–µ—Å–∫–æ–ª—å–∫–æ —Å–µ–∫—É–Ω–¥)

**–í–∞–∂–Ω–æ:** –ë–µ–∑ –≤–∫–ª—é—á–µ–Ω–Ω–æ–≥–æ API –∑–∞–ø—Ä–æ—Å—ã –Ω–µ –±—É–¥—É—Ç —Ä–∞–±–æ—Ç–∞—Ç—å!

### –®–∞–≥ 3: –°–æ–∑–¥–∞–Ω–∏–µ Service Account

1. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ **"IAM & Admin" ‚Üí "Service Accounts"**
2. –ù–∞–∂–º–∏—Ç–µ **"Create Service Account"** (–°–æ–∑–¥–∞—Ç—å Service Account)
3. –ó–∞–ø–æ–ª–Ω–∏—Ç–µ —Ñ–æ—Ä–º—É:
   - **Service account name:** `ga4-reader` (–∏–ª–∏ –ª—é–±–æ–µ –¥—Ä—É–≥–æ–µ)
   - **Service account ID:** –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∑–∞–ø–æ–ª–Ω–∏—Ç—Å—è
   - **Description:** `Service Account for GA4 Data API access`
4. –ù–∞–∂–º–∏—Ç–µ **"Create and Continue"**

### –®–∞–≥ 4: –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ —Ä–æ–ª–∏

1. –í —Ä–∞–∑–¥–µ–ª–µ **"Grant this service account access to project"**:
   - –í—ã–±–µ—Ä–∏—Ç–µ —Ä–æ–ª—å: **"Viewer"** –∏–ª–∏ **"Analytics Viewer"**
   - –ò–ª–∏ –Ω–∞–∂–º–∏—Ç–µ **"Skip"** (–º–æ–∂–Ω–æ –Ω–∞–∑–Ω–∞—á–∏—Ç—å –ø–æ–∑–∂–µ)
2. –ù–∞–∂–º–∏—Ç–µ **"Continue"**
3. –ù–∞–∂–º–∏—Ç–µ **"Done"**

### –®–∞–≥ 5: –°–æ–∑–¥–∞–Ω–∏–µ –∫–ª—é—á–∞ (JSON —Ñ–∞–π–ª)

1. –ù–∞–π–¥–∏—Ç–µ —Å–æ–∑–¥–∞–Ω–Ω—ã–π Service Account –≤ —Å–ø–∏—Å–∫–µ
2. –ù–∞–∂–º–∏—Ç–µ –Ω–∞ –Ω–µ–≥–æ
3. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤–æ –≤–∫–ª–∞–¥–∫—É **"Keys"**
4. –ù–∞–∂–º–∏—Ç–µ **"Add Key" ‚Üí "Create new key"**
5. –í—ã–±–µ—Ä–∏—Ç–µ —Ñ–æ—Ä–º–∞—Ç: **JSON**
6. –ù–∞–∂–º–∏—Ç–µ **"Create"**
7. **JSON —Ñ–∞–π–ª –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–∫–∞—á–∞–µ—Ç—Å—è!** –°–æ—Ö—Ä–∞–Ω–∏—Ç–µ –µ–≥–æ –≤ –±–µ–∑–æ–ø–∞—Å–Ω–æ–º –º–µ—Å—Ç–µ.

**‚ö†Ô∏è –í–ê–ñ–ù–û:** 
- –≠—Ç–æ—Ç —Ñ–∞–π–ª –º–æ–∂–Ω–æ —Å–∫–∞—á–∞—Ç—å —Ç–æ–ª—å–∫–æ –æ–¥–∏–Ω —Ä–∞–∑!
- –°–æ—Ö—Ä–∞–Ω–∏—Ç–µ –µ–≥–æ —Å—Ä–∞–∑—É –≤ –±–µ–∑–æ–ø–∞—Å–Ω–æ–µ –º–µ—Å—Ç–æ
- –ù–µ –¥–µ–ª–∏—Ç–µ—Å—å —ç—Ç–∏–º —Ñ–∞–π–ª–æ–º –Ω–∏ —Å –∫–µ–º

### –®–∞–≥ 6: –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ JSON —Ñ–∞–π–ª–∞

1. –°–æ–∑–¥–∞–π—Ç–µ –ø–∞–ø–∫—É `credentials` –≤ –∫–æ—Ä–Ω–µ –ø—Ä–æ–µ–∫—Ç–∞ (–µ—Å–ª–∏ –Ω–µ—Ç):
   ```bash
   mkdir -p credentials
   ```

2. –ü–µ—Ä–µ–º–µ—Å—Ç–∏—Ç–µ —Å–∫–∞—á–∞–Ω–Ω—ã–π JSON —Ñ–∞–π–ª –≤ —ç—Ç—É –ø–∞–ø–∫—É:
   ```bash
   mv ~/Downloads/your-project-xxxxx-xxxxx.json credentials/ga4-service-account.json
   ```

3. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ —Ñ–∞–π–ª –≤ `.gitignore`:
   ```bash
   echo "credentials/*.json" >> .gitignore
   ```

---

## üÜî –ü–æ–ª—É—á–µ–Ω–∏–µ Property ID

### –°–ø–æ—Å–æ–± 1: –ß–µ—Ä–µ–∑ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å GA4

1. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –Ω–∞ [https://analytics.google.com/](https://analytics.google.com/)
2. –í–æ–π–¥–∏—Ç–µ –≤ —Å–≤–æ–π –∞–∫–∫–∞—É–Ω—Ç
3. –í—ã–±–µ—Ä–∏—Ç–µ –Ω—É–∂–Ω—ã–π **Property**
4. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ **–ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä** (—à–µ—Å—Ç–µ—Ä–µ–Ω–∫–∞ –≤–Ω–∏–∑—É —Å–ª–µ–≤–∞)
5. –í —Ä–∞–∑–¥–µ–ª–µ **"Property"** –Ω–∞–∂–º–∏—Ç–µ **"–ù–∞—Å—Ç—Ä–æ–π–∫–∏ Property"**
6. –ù–∞–π–¥–∏—Ç–µ **"ID Property"** - —ç—Ç–æ –∏ –µ—Å—Ç—å –≤–∞—à Property ID (–Ω–∞–ø—Ä–∏–º–µ—Ä: `123456789`)

### –°–ø–æ—Å–æ–± 2: –ß–µ—Ä–µ–∑ URL

1. –û—Ç–∫—Ä–æ–π—Ç–µ GA4 –≤ –±—Ä–∞—É–∑–µ—Ä–µ
2. –ü–æ—Å–º–æ—Ç—Ä–∏—Ç–µ –Ω–∞ URL: `https://analytics.google.com/analytics/web/#/p123456789/`
3. –ß–∏—Å–ª–æ –ø–æ—Å–ª–µ `/p` - —ç—Ç–æ –≤–∞—à Property ID (`123456789`)

### –°–ø–æ—Å–æ–± 3: –ß–µ—Ä–µ–∑ Admin API (–ø—Ä–æ–≥—Ä–∞–º–º–Ω–æ)

–ï—Å–ª–∏ —É –≤–∞—Å –Ω–µ—Å–∫–æ–ª—å–∫–æ Properties, –º–æ–∂–Ω–æ –ø–æ–ª—É—á–∏—Ç—å —Å–ø–∏—Å–æ–∫ —á–µ—Ä–µ–∑ Admin API (—Ç—Ä–µ–±—É–µ—Ç –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–π –Ω–∞—Å—Ç—Ä–æ–π–∫–∏).

---

## üîí –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –¥–æ—Å—Ç—É–ø–∞

### –®–∞–≥ 1: –ü—Ä–µ–¥–æ—Å—Ç–∞–≤–ª–µ–Ω–∏–µ –¥–æ—Å—Ç—É–ø–∞ Service Account –∫ GA4 Property

1. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ GA4: [https://analytics.google.com/](https://analytics.google.com/)
2. –í—ã–±–µ—Ä–∏—Ç–µ –Ω—É–∂–Ω—ã–π **Property**
3. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ **–ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä** ‚Üí **"–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –¥–æ—Å—Ç—É–ø–æ–º –∫ —Ä–µ—Å—É—Ä—Å–∞–º"** (–∏–ª–∏ **"Property Access Management"**)
4. –ù–∞–∂–º–∏—Ç–µ **"+"** (–î–æ–±–∞–≤–∏—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π)
5. –í –ø–æ–ª–µ **"–î–æ–±–∞–≤–∏—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π"** –≤–≤–µ–¥–∏—Ç–µ email Service Account:
   - –§–æ—Ä–º–∞—Ç: `service-account-name@project-id.iam.gserviceaccount.com`
   - –ü—Ä–∏–º–µ—Ä: `ga4-reader@lead-gen-system.iam.gserviceaccount.com`
6. –í—ã–±–µ—Ä–∏—Ç–µ —Ä–æ–ª—å: **"–ü—Ä–æ—Å–º–æ—Ç—Ä"** (Viewer)
7. –ù–∞–∂–º–∏—Ç–µ **"–î–æ–±–∞–≤–∏—Ç—å"**

**–í–∞–∂–Ω–æ:** –ë–µ–∑ —ç—Ç–æ–≥–æ —à–∞–≥–∞ Service Account –Ω–µ —Å–º–æ–∂–µ—Ç –ø–æ–ª—É—á–∏—Ç—å –¥–æ—Å—Ç—É–ø –∫ –¥–∞–Ω–Ω—ã–º GA4!

---

## ‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –¥–ª—è –∞–≤—Ç–æ–Ω–æ–º–Ω–æ–π —Ä–∞–±–æ—Ç—ã

### –®–∞–≥ 1: –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –≤ `.env`

–û—Ç–∫—Ä–æ–π—Ç–µ —Ñ–∞–π–ª `.env` –≤ –∫–æ—Ä–Ω–µ –ø—Ä–æ–µ–∫—Ç–∞ –∏ –¥–æ–±–∞–≤—å—Ç–µ:

```env
# Google Analytics 4
GOOGLE_ANALYTICS_CREDENTIALS_PATH=credentials/ga4-service-account.json
GOOGLE_ANALYTICS_PROPERTY_ID=123456789
```

**–ì–¥–µ:**
- `GOOGLE_ANALYTICS_CREDENTIALS_PATH` - –ø—É—Ç—å –∫ JSON —Ñ–∞–π–ª—É Service Account (–æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ –∫–æ—Ä–Ω—è –ø—Ä–æ–µ–∫—Ç–∞)
- `GOOGLE_ANALYTICS_PROPERTY_ID` - ID –≤–∞—à–µ–≥–æ Property (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ, –Ω–æ —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)

### –®–∞–≥ 2: –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã —Ñ–∞–π–ª–æ–≤

–£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞ –≤—ã–≥–ª—è–¥–∏—Ç —Ç–∞–∫:

```
lead-generation-system/
‚îú‚îÄ‚îÄ .env
‚îú‚îÄ‚îÄ credentials/
‚îÇ   ‚îî‚îÄ‚îÄ ga4-service-account.json  ‚Üê –í–∞—à JSON —Ñ–∞–π–ª –∑–¥–µ—Å—å
‚îú‚îÄ‚îÄ core/
‚îú‚îÄ‚îÄ library/
‚îî‚îÄ‚îÄ ...
```

### –®–∞–≥ 3: –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–∞–≤ –¥–æ—Å—Ç—É–ø–∞ –∫ —Ñ–∞–π–ª—É

–£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ —Ñ–∞–π–ª credentials –¥–æ—Å—Ç—É–ø–µ–Ω –¥–ª—è —á—Ç–µ–Ω–∏—è:

```bash
chmod 600 credentials/ga4-service-account.json
```

---

## ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è

### –°–ø–æ—Å–æ–± 1: –ß–µ—Ä–µ–∑ API endpoint

1. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –±—ç–∫–µ–Ω–¥ –∑–∞–ø—É—â–µ–Ω:
   ```bash
   # –ü—Ä–æ–≤–µ—Ä–∫–∞, —á—Ç–æ —Å–µ—Ä–≤–µ—Ä —Ä–∞–±–æ—Ç–∞–µ—Ç
   curl http://localhost:8001/health
   ```

2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ endpoint Properties:
   ```bash
   curl http://localhost:8001/api/google-analytics/properties
   ```

3. –ï—Å–ª–∏ –≤—Å–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–æ –ø—Ä–∞–≤–∏–ª—å–Ω–æ, –≤—ã –¥–æ–ª–∂–Ω—ã —É–≤–∏–¥–µ—Ç—å:
   ```json
   {
     "properties": [
       {
         "id": "123456789",
         "name": "Your Property Name",
         "property": "properties/123456789"
       }
     ]
   }
   ```

### –°–ø–æ—Å–æ–± 2: –ß–µ—Ä–µ–∑ —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥

1. –û—Ç–∫—Ä–æ–π—Ç–µ –±—Ä–∞—É–∑–µ—Ä: `http://localhost:3000`
2. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ **Analytics ‚Üí Google Analytics 4**
3. –ï—Å–ª–∏ –≤—Å–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–æ –ø—Ä–∞–≤–∏–ª—å–Ω–æ, –≤—ã —É–≤–∏–¥–∏—Ç–µ —Å–ø–∏—Å–æ–∫ Properties –≤ –≤—ã–ø–∞–¥–∞—é—â–µ–º —Å–ø–∏—Å–∫–µ

### –°–ø–æ—Å–æ–± 3: –ß–µ—Ä–µ–∑ Python —Å–∫—Ä–∏–ø—Ç

–°–æ–∑–¥–∞–π—Ç–µ —Ç–µ—Å—Ç–æ–≤—ã–π —Å–∫—Ä–∏–ø—Ç `test_ga4.py`:

```python
import os
import asyncio
from library.integrations.google_analytics import GoogleAnalyticsClient

async def test():
    # –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∫–ª–∏–µ–Ω—Ç–∞
    client = GoogleAnalyticsClient()
    
    # –ü–æ–ª—É—á–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞ Properties
    properties = await client.get_properties()
    print(f"–ù–∞–π–¥–µ–Ω–æ Properties: {len(properties)}")
    for prop in properties:
        print(f"  - {prop['name']} (ID: {prop['id']})")
    
    # –ü–æ–ª—É—á–µ–Ω–∏–µ summary (–µ—Å–ª–∏ property_id —É–∫–∞–∑–∞–Ω)
    if client.property_id:
        summary = await client.get_summary(days=7)
        print(f"\nSummary –∑–∞ 7 –¥–Ω–µ–π:")
        print(f"  Sessions: {summary['metrics']['sessions']}")
        print(f"  Users: {summary['metrics']['users']}")

if __name__ == "__main__":
    asyncio.run(test())
```

–ó–∞–ø—É—Å—Ç–∏—Ç–µ:
```bash
python test_ga4.py
```

---

## üîí –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

### ‚úÖ –ß—Ç–æ –¥–µ–ª–∞—Ç—å:

1. **–•—Ä–∞–Ω–∏—Ç–µ JSON —Ñ–∞–π–ª –≤ –±–µ–∑–æ–ø–∞—Å–Ω–æ–º –º–µ—Å—Ç–µ**
   - –õ–æ–∫–∞–ª—å–Ω–æ: `credentials/ga4-service-account.json`
   - –ù–∞ —Å–µ—Ä–≤–µ—Ä–µ: –≤ –∑–∞—â–∏—â–µ–Ω–Ω–æ–π –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ —Å –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω—ã–º –¥–æ—Å—Ç—É–ø–æ–º

2. **–î–æ–±–∞–≤—å—Ç–µ –≤ `.gitignore`:**
   ```
   credentials/*.json
   *.json
   .env
   ```

3. **–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è** –¥–ª—è production:
   - –ù–µ —Ö—Ä–∞–Ω–∏—Ç–µ credentials –≤ –∫–æ–¥–µ
   - –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Å–µ–∫—Ä–µ—Ç—ã (AWS Secrets Manager, Google Secret Manager, etc.)

4. **–û–≥—Ä–∞–Ω–∏—á—å—Ç–µ –ø—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞:**
   - Service Account –¥–æ–ª–∂–µ–Ω –∏–º–µ—Ç—å —Ç–æ–ª—å–∫–æ —Ä–æ–ª—å `Viewer` (—á—Ç–µ–Ω–∏–µ)
   - –ù–µ –¥–∞–≤–∞–π—Ç–µ –ø—Ä–∞–≤–∞ –Ω–∞ –∑–∞–ø–∏—Å—å, –µ—Å–ª–∏ –æ–Ω–∏ –Ω–µ –Ω—É–∂–Ω—ã

5. **–†–µ–≥—É–ª—è—Ä–Ω–æ –ø—Ä–æ–≤–µ—Ä—è–π—Ç–µ –¥–æ—Å—Ç—É–ø:**
   - –ü–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–∏ –ø—Ä–æ–≤–µ—Ä—è–π—Ç–µ, –∫—Ç–æ –∏–º–µ–µ—Ç –¥–æ—Å—Ç—É–ø –∫ GA4 Property
   - –£–¥–∞–ª—è–π—Ç–µ –Ω–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ Service Accounts

### ‚ùå –ß–µ–≥–æ –ù–ï –¥–µ–ª–∞—Ç—å:

1. **–ù–ï –∫–æ–º–º–∏—Ç—å—Ç–µ JSON —Ñ–∞–π–ª –≤ Git**
2. **–ù–ï –¥–µ–ª–∏—Ç–µ—Å—å JSON —Ñ–∞–π–ª–æ–º** —á–µ—Ä–µ–∑ email, –º–µ—Å—Å–µ–Ω–¥–∂–µ—Ä—ã –∏ —Ç.–¥.
3. **–ù–ï –¥–∞–≤–∞–π—Ç–µ Service Account –±–æ–ª—å—à–µ –ø—Ä–∞–≤**, —á–µ–º –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ
4. **–ù–ï —Ö—Ä–∞–Ω–∏—Ç–µ credentials** –≤ –æ—Ç–∫—Ä—ã—Ç–æ–º –≤–∏–¥–µ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ

---

## üêõ –†–µ—à–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º

### –û—à–∏–±–∫–∞: "GOOGLE_ANALYTICS_CREDENTIALS_PATH –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω"

**–ü—Ä–∏—á–∏–Ω–∞:** –ü–µ—Ä–µ–º–µ–Ω–Ω–∞—è –æ–∫—Ä—É–∂–µ–Ω–∏—è –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∞ –∏–ª–∏ —Ñ–∞–π–ª –Ω–µ –Ω–∞–π–¥–µ–Ω.

**–†–µ—à–µ–Ω–∏–µ:**
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ –≤ `.env` –µ—Å—Ç—å —Å—Ç—Ä–æ–∫–∞: `GOOGLE_ANALYTICS_CREDENTIALS_PATH=credentials/ga4-service-account.json`
2. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ —Ñ–∞–π–ª —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –ø–æ —É–∫–∞–∑–∞–Ω–Ω–æ–º—É –ø—É—Ç–∏
3. –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ –±—ç–∫–µ–Ω–¥ –ø–æ—Å–ª–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è `.env`

### –û—à–∏–±–∫–∞: "–§–∞–π–ª credentials –Ω–µ –Ω–∞–π–¥–µ–Ω"

**–ü—Ä–∏—á–∏–Ω–∞:** –ü—É—Ç—å –∫ JSON —Ñ–∞–π–ª—É —É–∫–∞–∑–∞–Ω –Ω–µ–≤–µ—Ä–Ω–æ.

**–†–µ—à–µ–Ω–∏–µ:**
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø—É—Ç—å –≤ `.env` (–æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ –∫–æ—Ä–Ω—è –ø—Ä–æ–µ–∫—Ç–∞)
2. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ —Ñ–∞–π–ª —Å—É—â–µ—Å—Ç–≤—É–µ—Ç: `ls -la credentials/ga4-service-account.json`
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞: `chmod 600 credentials/ga4-service-account.json`

### –û—à–∏–±–∫–∞: "–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ credentials"

**–ü—Ä–∏—á–∏–Ω–∞:** JSON —Ñ–∞–π–ª –ø–æ–≤—Ä–µ–∂–¥–µ–Ω –∏–ª–∏ –∏–º–µ–µ—Ç –Ω–µ–≤–µ—Ä–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç.

**–†–µ—à–µ–Ω–∏–µ:**
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ JSON —Ñ–∞–π–ª –≤–∞–ª–∏–¥–Ω—ã–π: `cat credentials/ga4-service-account.json | python -m json.tool`
2. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ —Ñ–∞–π–ª –Ω–µ –ø–æ–≤—Ä–µ–∂–¥–µ–Ω (—Å–∫–∞—á–∞–π—Ç–µ –∑–∞–Ω–æ–≤–æ –∏–∑ Google Cloud Console)

### –û—à–∏–±–∫–∞: "403 Forbidden" –∏–ª–∏ "Permission denied"

**–ü—Ä–∏—á–∏–Ω–∞:** Service Account –Ω–µ –∏–º–µ–µ—Ç –¥–æ—Å—Ç—É–ø–∞ –∫ GA4 Property.

**–†–µ—à–µ–Ω–∏–µ:**
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ Service Account –¥–æ–±–∞–≤–ª–µ–Ω –≤ GA4 Property —Å —Ä–æ–ª—å—é "Viewer"
2. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ Google Analytics Data API –≤–∫–ª—é—á–µ–Ω –≤ Google Cloud Console
3. –ü–æ–¥–æ–∂–¥–∏—Ç–µ –Ω–µ—Å–∫–æ–ª—å–∫–æ –º–∏–Ω—É—Ç –ø–æ—Å–ª–µ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –¥–æ—Å—Ç—É–ø–∞ (–º–æ–∂–µ—Ç –±—ã—Ç—å –∑–∞–¥–µ—Ä–∂–∫–∞)

### –û—à–∏–±–∫–∞: "API not enabled"

**–ü—Ä–∏—á–∏–Ω–∞:** Google Analytics Data API –Ω–µ –≤–∫–ª—é—á–µ–Ω –≤ –ø—Ä–æ–µ–∫—Ç–µ.

**–†–µ—à–µ–Ω–∏–µ:**
1. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ Google Cloud Console ‚Üí APIs & Services ‚Üí Library
2. –ù–∞–π–¥–∏—Ç–µ "Google Analytics Data API"
3. –ù–∞–∂–º–∏—Ç–µ "Enable"

### –û—à–∏–±–∫–∞: "Property not found"

**–ü—Ä–∏—á–∏–Ω–∞:** Property ID —É–∫–∞–∑–∞–Ω –Ω–µ–≤–µ—Ä–Ω–æ –∏–ª–∏ Service Account –Ω–µ –∏–º–µ–µ—Ç –¥–æ—Å—Ç—É–ø–∞.

**–†–µ—à–µ–Ω–∏–µ:**
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ Property ID –≤ `.env`
2. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ Service Account –∏–º–µ–µ—Ç –¥–æ—Å—Ç—É–ø –∫ —ç—Ç–æ–º—É Property
3. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –ø–æ–ª—É—á–∏—Ç—å —Å–ø–∏—Å–æ–∫ Properties —á–µ—Ä–µ–∑ `/api/google-analytics/properties`

---

## üìù –ß–µ–∫–ª–∏—Å—Ç –Ω–∞—Å—Ç—Ä–æ–π–∫–∏

- [ ] –°–æ–∑–¥–∞–Ω –ø—Ä–æ–µ–∫—Ç –≤ Google Cloud Console
- [ ] –í–∫–ª—é—á–µ–Ω Google Analytics Data API
- [ ] –°–æ–∑–¥–∞–Ω Service Account
- [ ] –°–∫–∞—á–∞–Ω JSON —Ñ–∞–π–ª —Å credentials
- [ ] JSON —Ñ–∞–π–ª —Å–æ—Ö—Ä–∞–Ω–µ–Ω –≤ `credentials/ga4-service-account.json`
- [ ] JSON —Ñ–∞–π–ª –¥–æ–±–∞–≤–ª–µ–Ω –≤ `.gitignore`
- [ ] Service Account –¥–æ–±–∞–≤–ª–µ–Ω –≤ GA4 Property —Å —Ä–æ–ª—å—é "Viewer"
- [ ] –î–æ–±–∞–≤–ª–µ–Ω—ã –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –≤ `.env`:
  - [ ] `GOOGLE_ANALYTICS_CREDENTIALS_PATH`
  - [ ] `GOOGLE_ANALYTICS_PROPERTY_ID` (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
- [ ] –ë—ç–∫–µ–Ω–¥ –ø–µ—Ä–µ–∑–∞–ø—É—â–µ–Ω –ø–æ—Å–ª–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è `.env`
- [ ] –ü—Ä–æ–≤–µ—Ä–µ–Ω endpoint `/api/google-analytics/properties`
- [ ] –ü—Ä–æ–≤–µ—Ä–µ–Ω —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥ (—Å–ø–∏—Å–æ–∫ Properties –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è)

---

## üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

–ï—Å–ª–∏ —É –≤–∞—Å —É–∂–µ –µ—Å—Ç—å Google Cloud –ø—Ä–æ–µ–∫—Ç –∏ GA4 Property:

1. **–°–æ–∑–¥–∞–π—Ç–µ Service Account:**
   - Google Cloud Console ‚Üí IAM & Admin ‚Üí Service Accounts ‚Üí Create
   - –ù–∞–∑–≤–∞–Ω–∏–µ: `ga4-reader`
   - –†–æ–ª—å: `Viewer`

2. **–°–∫–∞—á–∞–π—Ç–µ JSON –∫–ª—é—á:**
   - Keys ‚Üí Add Key ‚Üí Create new key ‚Üí JSON
   - –°–æ—Ö—Ä–∞–Ω–∏—Ç–µ –∫–∞–∫ `credentials/ga4-service-account.json`

3. **–î–æ–±–∞–≤—å—Ç–µ –¥–æ—Å—Ç—É–ø –≤ GA4:**
   - GA4 ‚Üí –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä ‚Üí –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –¥–æ—Å—Ç—É–ø–æ–º
   - –î–æ–±–∞–≤—å—Ç–µ email Service Account —Å —Ä–æ–ª—å—é "–ü—Ä–æ—Å–º–æ—Ç—Ä"

4. **–ù–∞—Å—Ç—Ä–æ–π—Ç–µ `.env`:**
   ```env
   GOOGLE_ANALYTICS_CREDENTIALS_PATH=credentials/ga4-service-account.json
   GOOGLE_ANALYTICS_PROPERTY_ID=123456789
   ```

5. **–ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ –±—ç–∫–µ–Ω–¥ –∏ –ø—Ä–æ–≤–µ—Ä—å—Ç–µ!**

---

**–ì–æ—Ç–æ–≤–æ!** –¢–µ–ø–µ—Ä—å —Å–∏—Å—Ç–µ–º–∞ –º–æ–∂–µ—Ç –∞–≤—Ç–æ–Ω–æ–º–Ω–æ —Ä–∞–±–æ—Ç–∞—Ç—å —Å Google Analytics 4. üéâ


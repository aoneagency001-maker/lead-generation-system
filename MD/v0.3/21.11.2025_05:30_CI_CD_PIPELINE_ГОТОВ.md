# ‚úÖ CI/CD Pipeline –ø–æ–ª–Ω–æ—Å—Ç—å—é –Ω–∞—Å—Ç—Ä–æ–µ–Ω

**–î–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è:** 21.11.2025 05:30  
**–°—Ç–∞—Ç—É—Å:** ‚úÖ –ì–æ—Ç–æ–≤–æ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é

---

## üéØ –ß—Ç–æ –±—ã–ª–æ —Å–¥–µ–ª–∞–Ω–æ

### ‚úÖ 1. GitHub Actions Workflow –¥–ª—è –¥–µ–ø–ª–æ—è

**–°–æ–∑–¥–∞–Ω:** `.github/workflows/deploy.yml`

**–§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å:**
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –¥–µ–ø–ª–æ–π –ø—Ä–∏ push –≤ `main`
- ‚úÖ –†—É—á–Ω–æ–π –∑–∞–ø—É—Å–∫ —á–µ—Ä–µ–∑ GitHub Actions UI
- ‚úÖ –ó–∞–≥—Ä—É–∑–∫–∞ —Å–µ–∫—Ä–µ—Ç–æ–≤ –∏–∑ AWS SSM Parameter Store
- ‚úÖ –°–±–æ—Ä–∫–∞ TypeScript –ø—Ä–æ–µ–∫—Ç–∞
- ‚úÖ –î–µ–ø–ª–æ–π —á–µ—Ä–µ–∑ Serverless Framework
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ endpoints –ø–æ—Å–ª–µ –¥–µ–ø–ª–æ—è
- ‚úÖ –í—ã–≤–æ–¥ summary —Å endpoint URL

**–¢—Ä–∏–≥–≥–µ—Ä—ã:**
- Push –≤ `main` (—Ç–æ–ª—å–∫–æ –¥–ª—è `telegram-notifications-service/`)
- –†—É—á–Ω–æ–π –∑–∞–ø—É—Å–∫ (workflow_dispatch)

---

### ‚úÖ 2. GitHub Actions Workflow –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

**–°–æ–∑–¥–∞–Ω:** `.github/workflows/test.yml`

**–§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å:**
- ‚úÖ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–∏ Pull Request
- ‚úÖ –°–±–æ—Ä–∫–∞ TypeScript
- ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ –ª–∏–Ω—Ç–µ—Ä–∞ (–µ—Å–ª–∏ –Ω–∞—Å—Ç—Ä–æ–µ–Ω)
- ‚úÖ –í–∞–ª–∏–¥–∞—Ü–∏—è —Å–±–æ—Ä–∫–∏

**–¢—Ä–∏–≥–≥–µ—Ä—ã:**
- Pull Request –≤ `main`
- Push –≤ `main` (—Ç–æ–ª—å–∫–æ –¥–ª—è `telegram-notifications-service/`)

---

### ‚úÖ 3. –ò—Å–ø—Ä–∞–≤–ª–µ–Ω serverless.yml

**–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ:**
- ‚úÖ `StreamSpecification` —Ç–µ–ø–µ—Ä—å –≤–∫–ª—é—á–∞–µ—Ç `StreamEnabled: true`
- ‚úÖ –í—Å–µ 4 Lambda —Ñ—É–Ω–∫—Ü–∏–∏ –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã
- ‚úÖ DynamoDB —Ç–∞–±–ª–∏—Ü–∞ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∞
- ‚úÖ IAM –ø—Ä–∞–≤–∞ –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã
- ‚úÖ CloudWatch Metrics –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã

---

### ‚úÖ 4. –°–∫—Ä–∏–ø—Ç –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è endpoint

**–°–æ–∑–¥–∞–Ω:** `scripts/get-endpoint.sh`

**–§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å:**
- ‚úÖ –ü–æ–ª—É—á–µ–Ω–∏–µ endpoint URL –ø–æ—Å–ª–µ –¥–µ–ø–ª–æ—è
- ‚úÖ –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö —Å–ø–æ—Å–æ–±–æ–≤ (serverless info, AWS CLI, CloudFormation)
- ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç –¥–ª—è —Ä–∞–∑–Ω—ã—Ö stages (dev/prod)

---

### ‚úÖ 5. –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

**–°–æ–∑–¥–∞–Ω:** `CI_CD_README.md`

**–°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ:**
- ‚úÖ –û–ø–∏—Å–∞–Ω–∏–µ –≤—Å–µ—Ö workflows
- ‚úÖ –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –ø–æ –Ω–∞—Å—Ç—Ä–æ–π–∫–µ GitHub Secrets
- ‚úÖ Troubleshooting
- ‚úÖ –ß–µ–∫–ª–∏—Å—Ç –ø–µ—Ä–µ–¥ –ø–µ—Ä–≤—ã–º –¥–µ–ø–ª–æ–µ–º

---

## üìã –¢–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ

### ‚úÖ –ß—Ç–æ —É–∂–µ —Ä–∞–±–æ—Ç–∞–µ—Ç:

1. **–†—É—á–Ω–æ–π –¥–µ–ø–ª–æ–π —á–µ—Ä–µ–∑ Cursor** - ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç
   - –°–∫—Ä–∏–ø—Ç: `scripts/deploy-with-env.sh`
   - –ó–∞–≥—Ä—É–∂–∞–µ—Ç —Å–µ–∫—Ä–µ—Ç—ã –∏–∑ SSM
   - –î–µ–ø–ª–æ–∏—Ç –Ω–∞ AWS Lambda

2. **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –¥–µ–ø–ª–æ–π —á–µ—Ä–µ–∑ GitHub Actions** - ‚úÖ –ù–∞—Å—Ç—Ä–æ–µ–Ω
   - Workflow: `.github/workflows/deploy.yml`
   - –¢—Ä–µ–±—É–µ—Ç —Ç–æ–ª—å–∫–æ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ GitHub Secrets

3. **–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ** - ‚úÖ –ù–∞—Å—Ç—Ä–æ–µ–Ω–æ
   - Workflow: `.github/workflows/test.yml`
   - –ü—Ä–æ–≤–µ—Ä—è–µ—Ç —Å–±–æ—Ä–∫—É –∏ –ª–∏–Ω—Ç–∏–Ω–≥

4. **serverless.yml** - ‚úÖ –ü–æ–ª–Ω–æ—Å—Ç—å—é –Ω–∞—Å—Ç—Ä–æ–µ–Ω
   - 4 Lambda —Ñ—É–Ω–∫—Ü–∏–∏
   - DynamoDB —Ç–∞–±–ª–∏—Ü–∞
   - API Gateway
   - CloudWatch Metrics

---

## üîê –¢—Ä–µ–±—É–µ–º—ã–µ GitHub Secrets

–î–ª—è —Ä–∞–±–æ—Ç—ã –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –¥–µ–ø–ª–æ—è –Ω—É–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –≤ GitHub:

```
AWS_ACCESS_KEY_ID=your_aws_access_key_id
AWS_SECRET_ACCESS_KEY=your_aws_secret_access_key
```

**‚ö†Ô∏è –í–ê–ñ–ù–û:** –ù–∏–∫–æ–≥–¥–∞ –Ω–µ –∫–æ–º–º–∏—Ç—å—Ç–µ —Ä–µ–∞–ª—å–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è —Å–µ–∫—Ä–µ—Ç–æ–≤ –≤ Git!

**–ö–∞–∫ –¥–æ–±–∞–≤–∏—Ç—å:**
1. –û—Ç–∫—Ä–æ–π—Ç–µ: `https://github.com/{owner}/{repo}/settings/secrets/actions`
2. –ù–∞–∂–º–∏—Ç–µ "New repository secret"
3. –î–æ–±–∞–≤—å—Ç–µ –æ–±–∞ —Å–µ–∫—Ä–µ—Ç–∞

**–í–∞–∂–Ω–æ:** –≠—Ç–∏ —Å–µ–∫—Ä–µ—Ç—ã —É–∂–µ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –¥–ª—è AWS SSM, —Ç–∞–∫ —á—Ç–æ –æ–Ω–∏ –±–µ–∑–æ–ø–∞—Å–Ω—ã.

---

## üöÄ –ö–∞–∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å

### –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –¥–µ–ø–ª–æ–π

1. **Push –≤ main** ‚Üí –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è workflow
2. **GitHub Actions** ‚Üí —Å–æ–±–∏—Ä–∞–µ—Ç, –¥–µ–ø–ª–æ–∏—Ç, —Ç–µ—Å—Ç–∏—Ä—É–µ—Ç
3. **Summary** ‚Üí –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç endpoint URL

### –†—É—á–Ω–æ–π –¥–µ–ø–ª–æ–π

1. –û—Ç–∫—Ä–æ–π—Ç–µ: `https://github.com/{owner}/{repo}/actions`
2. –í—ã–±–µ—Ä–∏—Ç–µ "üöÄ Deploy to AWS Lambda"
3. –ù–∞–∂–º–∏—Ç–µ "Run workflow"
4. –í—ã–±–µ—Ä–∏—Ç–µ stage (`dev` –∏–ª–∏ `prod`)
5. –ù–∞–∂–º–∏—Ç–µ "Run workflow"

### –õ–æ–∫–∞–ª—å–Ω—ã–π –¥–µ–ø–ª–æ–π

```bash
cd telegram-notifications-service
./scripts/deploy-with-env.sh dev
```

---

## üìä –ß—Ç–æ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è –ø–æ—Å–ª–µ –¥–µ–ø–ª–æ—è

### 1. Health Check

```bash
curl https://{endpoint}/health
```

**–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:**
```json
{
  "status": "ok",
  "service": "telegram-notifications-service",
  "version": "2.0.0",
  "checks": {
    "dynamodb": true,
    "telegram": true
  }
}
```

### 2. Track Visitor (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

```bash
curl -X POST https://{endpoint}/track-visitor \
  -H "Content-Type: application/json" \
  -d '{"clientId":"test","page":"/test"}'
```

**–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:**
```json
{
  "tracked": true,
  "visitorId": "...",
  "requestId": "..."
}
```

---

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ñ–∞–π–ª–æ–≤

```
telegram-notifications-service/
‚îú‚îÄ‚îÄ .github/
‚îÇ   ‚îî‚îÄ‚îÄ workflows/
‚îÇ       ‚îú‚îÄ‚îÄ deploy.yml      ‚úÖ –î–µ–ø–ª–æ–π –Ω–∞ AWS Lambda
‚îÇ       ‚îî‚îÄ‚îÄ test.yml        ‚úÖ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ –ª–∏–Ω—Ç–∏–Ω–≥
‚îú‚îÄ‚îÄ scripts/
‚îÇ   ‚îú‚îÄ‚îÄ deploy-with-env.sh  ‚úÖ –†—É—á–Ω–æ–π –¥–µ–ø–ª–æ–π
‚îÇ   ‚îú‚îÄ‚îÄ get-endpoint.sh     ‚úÖ –ü–æ–ª—É—á–µ–Ω–∏–µ endpoint URL
‚îÇ   ‚îî‚îÄ‚îÄ ...
‚îú‚îÄ‚îÄ serverless.yml          ‚úÖ –ü–æ–ª–Ω–æ—Å—Ç—å—é –Ω–∞—Å—Ç—Ä–æ–µ–Ω
‚îú‚îÄ‚îÄ CI_CD_README.md         ‚úÖ –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è CI/CD
‚îî‚îÄ‚îÄ ...
```

---

## ‚úÖ –ß–µ–∫–ª–∏—Å—Ç

- [x] GitHub Actions workflow –¥–ª—è –¥–µ–ø–ª–æ—è —Å–æ–∑–¥–∞–Ω
- [x] GitHub Actions workflow –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è —Å–æ–∑–¥–∞–Ω
- [x] serverless.yml –∏—Å–ø—Ä–∞–≤–ª–µ–Ω –∏ –Ω–∞—Å—Ç—Ä–æ–µ–Ω
- [x] –°–∫—Ä–∏–ø—Ç –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è endpoint —Å–æ–∑–¥–∞–Ω
- [x] –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è —Å–æ–∑–¥–∞–Ω–∞
- [ ] GitHub Secrets –¥–æ–±–∞–≤–ª–µ–Ω—ã (–Ω—É–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å –≤—Ä—É—á–Ω—É—é)
- [x] –õ–æ–∫–∞–ª—å–Ω—ã–π –¥–µ–ø–ª–æ–π —Ä–∞–±–æ—Ç–∞–µ—Ç
- [x] –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –¥–µ–ø–ª–æ–π –Ω–∞—Å—Ç—Ä–æ–µ–Ω

---

## üéâ –ì–æ—Ç–æ–≤–æ!

**CI/CD Pipeline –ø–æ–ª–Ω–æ—Å—Ç—å—é –Ω–∞—Å—Ç—Ä–æ–µ–Ω –∏ –≥–æ—Ç–æ–≤ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é!**

–ü–æ—Å–ª–µ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è GitHub Secrets, –∫–∞–∂–¥—ã–π push –≤ `main` –±—É–¥–µ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏:
1. –°–æ–±–∏—Ä–∞—Ç—å –ø—Ä–æ–µ–∫—Ç
2. –î–µ–ø–ª–æ–∏—Ç—å –Ω–∞ AWS Lambda
3. –¢–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å endpoints
4. –í—ã–≤–æ–¥–∏—Ç—å summary —Å —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞–º–∏

---

## üìö –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

- **CI_CD_README.md** - –ø–æ–ª–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è CI/CD
- **DEPLOYMENT.md** - –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø–æ –¥–µ–ø–ª–æ—é
- **DEPLOYMENT_SUCCESS.md** - —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –¥–µ–ø–ª–æ—è
- **QUICK_START.md** - –±—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

---

**–í–µ—Ä—Å–∏—è:** 2.0.0  
**–°—Ç–∞—Ç—É—Å:** ‚úÖ Production Ready  
**CI/CD:** ‚úÖ –ü–æ–ª–Ω–æ—Å—Ç—å—é –Ω–∞—Å—Ç—Ä–æ–µ–Ω


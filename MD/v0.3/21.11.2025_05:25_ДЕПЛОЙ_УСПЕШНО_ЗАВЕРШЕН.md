# ‚úÖ –î–µ–ø–ª–æ–π Telegram Notifications Service —É—Å–ø–µ—à–Ω–æ –∑–∞–≤–µ—Ä—à—ë–Ω!

**–î–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è:** 21.11.2025 05:25  
**–°—Ç–∞—Ç—É—Å:** ‚úÖ –í—Å–µ endpoints —Ä–∞–±–æ—Ç–∞—é—Ç  
**–†–µ–≥–∏–æ–Ω:** eu-central-1 (Frankfurt)

---

## üéØ –ß—Ç–æ –±—ã–ª–æ —Å–¥–µ–ª–∞–Ω–æ

1. ‚úÖ **–ù–∞—Å—Ç—Ä–æ–µ–Ω—ã AWS credentials** - –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ AWS –∞–∫–∫–∞—É–Ω—Ç—É
2. ‚úÖ **–ü–æ–ª—É—á–µ–Ω Chat ID** - —á–µ—Ä–µ–∑ Telegram Bot API (280192618)
3. ‚úÖ **–°–æ—Ö—Ä–∞–Ω–µ–Ω—ã —Å–µ–∫—Ä–µ—Ç—ã –≤ SSM** - BOT_TOKEN –∏ CHAT_ID
4. ‚úÖ **–ò—Å–ø—Ä–∞–≤–ª–µ–Ω—ã –ø—Ä–æ–±–ª–µ–º—ã —Å UUID** - –∑–∞–º–µ–Ω—ë–Ω –Ω–∞ `crypto.randomUUID()`
5. ‚úÖ **–°–æ–∑–¥–∞–Ω–∞ DynamoDB —Ç–∞–±–ª–∏—Ü–∞** - `telegram-notifications-events-dev`
6. ‚úÖ **–í—ã–ø–æ–ª–Ω–µ–Ω –¥–µ–ø–ª–æ–π** - –≤—Å–µ Lambda —Ñ—É–Ω–∫—Ü–∏–∏ —Ä–∞–∑–≤—ë—Ä–Ω—É—Ç—ã
7. ‚úÖ **–ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω—ã endpoints** - –≤—Å–µ —Ä–∞–±–æ—Ç–∞—é—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ

---

## üåê –†–∞–∑–≤—ë—Ä–Ω—É—Ç—ã–µ endpoints

**Base URL:** `https://cppf0omfz6.execute-api.eu-central-1.amazonaws.com`

### –î–æ—Å—Ç—É–ø–Ω—ã–µ endpoints:

1. **POST** `/track-visitor` - ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç
2. **POST** `/tilda-webhook` - ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç
3. **POST** `/metrika-webhook` - ‚úÖ –†–∞–∑–≤—ë—Ä–Ω—É—Ç
4. **GET** `/health` - ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç

---

## üß™ –†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

### Health Check

```bash
curl https://cppf0omfz6.execute-api.eu-central-1.amazonaws.com/health
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç
```json
{
  "status": "ok",
  "service": "telegram-notifications-service",
  "version": "2.0.0",
  "checks": {
    "dynamodb": true,
    "telegram": true
  }
}
```

### Track Visitor

**–¢–µ—Å—Ç:**
```bash
curl -X POST https://cppf0omfz6.execute-api.eu-central-1.amazonaws.com/track-visitor \
  -H "Content-Type: application/json" \
  -H "User-Agent: Mozilla/5.0" \
  -d '{"clientId":"test","page":"/","referrer":"https://google.com"}'
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç
```json
{
  "tracked": true,
  "visitorId": "df3e6155-45cb-4731-b9a0-854c99983690",
  "requestId": "6de0a938"
}
```

### Tilda Webhook

**–¢–µ—Å—Ç:**
```bash
curl -X POST https://cppf0omfz6.execute-api.eu-central-1.amazonaws.com/tilda-webhook \
  -H "Content-Type: application/json" \
  -d '{"name":"–ò–≤–∞–Ω","phone":"+77771234567","message":"–•–æ—á—É –∑–∞–∫–∞–∑–∞—Ç—å"}'
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç
```json
{
  "success": true,
  "message": "Notification sent",
  "requestId": "89c6f060"
}
```

---

## üîê –ù–∞—Å—Ç—Ä–æ–µ–Ω–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã

### AWS Systems Manager Parameter Store

‚úÖ `/telegram-notifications/BOT_TOKEN` - —Å–æ—Ö—Ä–∞–Ω—ë–Ω  
‚úÖ `/telegram-notifications/CHAT_ID` - —Å–æ—Ö—Ä–∞–Ω—ë–Ω (280192618)

### AWS Resources

‚úÖ **4 Lambda —Ñ—É–Ω–∫—Ü–∏–∏:**
- `telegram-notifications-service-dev-trackVisitor` (6.8 MB)
- `telegram-notifications-service-dev-tildaWebhook` (6.8 MB)
- `telegram-notifications-service-dev-metrikaWebhook` (6.8 MB)
- `telegram-notifications-service-dev-health` (6.8 MB)

‚úÖ **API Gateway HTTP API** - —Å–æ–∑–¥–∞–Ω –∏ –Ω–∞—Å—Ç—Ä–æ–µ–Ω

‚úÖ **DynamoDB —Ç–∞–±–ª–∏—Ü–∞** - `telegram-notifications-events-dev` (ACTIVE)

‚úÖ **CloudWatch Logs** - –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã

‚úÖ **CloudWatch Metrics** - –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –æ—Ç–ø—Ä–∞–≤–∫–∞ –º–µ—Ç—Ä–∏–∫

---

## üîß –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã

### 1. UUID ES Module –ø—Ä–æ–±–ª–µ–º–∞

**–ü—Ä–æ–±–ª–µ–º–∞:** uuid v13 - —ç—Ç–æ ES Module, –Ω–µ—Å–æ–≤–º–µ—Å—Ç–∏–º —Å CommonJS –≤ Lambda

**–†–µ—à–µ–Ω–∏–µ:** –ó–∞–º–µ–Ω—ë–Ω –Ω–∞ `crypto.randomUUID()` (–Ω–∞—Ç–∏–≤–Ω—ã–π Node.js 18+)

**–ò–∑–º–µ–Ω–µ–Ω–∏—è:**
- –í—Å–µ handlers –∏—Å–ø–æ–ª—å–∑—É—é—Ç `import { randomUUID } from 'crypto'`
- –£–¥–∞–ª–µ–Ω–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—å –æ—Ç uuid –ø–∞–∫–µ—Ç–∞

### 2. DynamoDB —Ç–∞–±–ª–∏—Ü–∞ –Ω–µ —Å–æ–∑–¥–∞–≤–∞–ª–∞—Å—å

**–ü—Ä–æ–±–ª–µ–º–∞:** –¢–∞–±–ª–∏—Ü–∞ –Ω–µ –±—ã–ª–∞ —Å–æ–∑–¥–∞–Ω–∞ –ø—Ä–∏ –ø–µ—Ä–≤–æ–º –¥–µ–ø–ª–æ–µ

**–†–µ—à–µ–Ω–∏–µ:** –°–æ–∑–¥–∞–Ω–∞ –≤—Ä—É—á–Ω—É—é —á–µ—Ä–µ–∑ —Å–∫—Ä–∏–ø—Ç `scripts/create-dynamodb-table.js`

### 3. SSM –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –Ω–µ —á–∏—Ç–∞–ª–∏—Å—å

**–ü—Ä–æ–±–ª–µ–º–∞:** Serverless Framework –Ω–µ –º–æ–≥ —á–∏—Ç–∞—Ç—å SSM –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –Ω–∞–ø—Ä—è–º—É—é

**–†–µ—à–µ–Ω–∏–µ:** –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Å–∫—Ä–∏–ø—Ç `scripts/deploy-with-env.sh`, –∫–æ—Ç–æ—Ä—ã–π:
1. –ó–∞–≥—Ä—É–∂–∞–µ—Ç –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –∏–∑ SSM
2. –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç –∏—Ö –∫–∞–∫ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è
3. –í—ã–ø–æ–ª–Ω—è–µ—Ç –¥–µ–ø–ª–æ–π

---

## üìä –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

### CloudWatch Logs

–í—Å–µ –ª–æ–≥–∏ –¥–æ—Å—Ç—É–ø–Ω—ã –≤:
- `/aws/lambda/telegram-notifications-service-dev-trackVisitor`
- `/aws/lambda/telegram-notifications-service-dev-tildaWebhook`
- `/aws/lambda/telegram-notifications-service-dev-metrikaWebhook`
- `/aws/lambda/telegram-notifications-service-dev-health`

### CloudWatch Metrics

Namespace: `TelegramNotifications/dev`

–ú–µ—Ç—Ä–∏–∫–∏:
- `visit_events` - —Å–æ–±—ã—Ç–∏—è –≤–∏–∑–∏—Ç–æ–≤ (success/error)
- `form_events` - –∑–∞—è–≤–∫–∏ (success/error)
- `metrika_events` - —Å–æ–±—ã—Ç–∏—è –ú–µ—Ç—Ä–∏–∫–∏ (success/error)
- `telegram_notifications` - —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è (success/error)
- `errors` - –æ—à–∏–±–∫–∏ –ø–æ —Ç–∏–ø–∞–º
- `*_duration` - –¥–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è

---

## üîó –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è

### Tilda Webhook

**URL –¥–ª—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∏:**
```
https://cppf0omfz6.execute-api.eu-central-1.amazonaws.com/tilda-webhook
```

**–ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è:**
1. Tilda ‚Üí –ù–∞—Å—Ç—Ä–æ–π–∫–∏ —Ñ–æ—Ä–º—ã ‚Üí –û—Ç–ø—Ä–∞–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö
2. –í—ã–±–µ—Ä–∏—Ç–µ "Webhook"
3. –í—Å—Ç–∞–≤—å—Ç–µ URL –≤—ã—à–µ
4. –ú–µ—Ç–æ–¥: POST
5. Content-Type: application/json

### JavaScript —Ç—Ä–µ–∫–∏–Ω–≥

```javascript
fetch('https://cppf0omfz6.execute-api.eu-central-1.amazonaws.com/track-visitor', {
  method: 'POST',
  headers: { 'Content-Type': 'application/json' },
  body: JSON.stringify({
    clientId: 'your_client_id',
    page: window.location.pathname,
    referrer: document.referrer,
    screenResolution: `${screen.width}x${screen.height}`,
    sessionId: getSessionId(),
    utmSource: new URLSearchParams(window.location.search).get('utm_source'),
    utmMedium: new URLSearchParams(window.location.search).get('utm_medium'),
  }),
}).catch(() => {});
```

---

## üìù –°–æ–∑–¥–∞–Ω–Ω—ã–µ —Å–∫—Ä–∏–ø—Ç—ã

1. **scripts/setup-aws.js** - –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ SSM –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤
2. **scripts/get-chat-id.js** - –ø–æ–ª—É—á–µ–Ω–∏–µ Chat ID
3. **scripts/deploy-with-env.sh** - –¥–µ–ø–ª–æ–π —Å –∑–∞–≥—Ä—É–∑–∫–æ–π –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –∏–∑ SSM
4. **scripts/create-dynamodb-table.js** - —Å–æ–∑–¥–∞–Ω–∏–µ DynamoDB —Ç–∞–±–ª–∏—Ü—ã
5. **scripts/check-logs.js** - –ø—Ä–æ–≤–µ—Ä–∫–∞ –ª–æ–≥–æ–≤ CloudWatch
6. **scripts/check-dynamodb.js** - –ø—Ä–æ–≤–µ—Ä–∫–∞ DynamoDB —Ç–∞–±–ª–∏—Ü—ã

---

## üîÑ –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ

–î–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –∫–æ–¥–∞:

```bash
cd telegram-notifications-service
npm run build
./scripts/deploy-with-env.sh dev
```

---

## ‚úÖ –§–∏–Ω–∞–ª—å–Ω—ã–π —á–µ–∫–ª–∏—Å—Ç

- [x] AWS credentials –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã
- [x] Chat ID –ø–æ–ª—É—á–µ–Ω (280192618)
- [x] –°–µ–∫—Ä–µ—Ç—ã —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã –≤ SSM
- [x] UUID –ø—Ä–æ–±–ª–µ–º–∞ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∞
- [x] DynamoDB —Ç–∞–±–ª–∏—Ü–∞ —Å–æ–∑–¥–∞–Ω–∞
- [x] –ü—Ä–æ–µ–∫—Ç —Å–æ–±—Ä–∞–Ω
- [x] –î–µ–ø–ª–æ–π –≤—ã–ø–æ–ª–Ω–µ–Ω —É—Å–ø–µ—à–Ω–æ
- [x] Health check —Ä–∞–±–æ—Ç–∞–µ—Ç
- [x] Track-visitor —Ä–∞–±–æ—Ç–∞–µ—Ç
- [x] Tilda-webhook —Ä–∞–±–æ—Ç–∞–µ—Ç
- [x] Telegram —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã
- [x] CloudWatch –ª–æ–≥–∏ —Ä–∞–±–æ—Ç–∞—é—Ç
- [x] CloudWatch –º–µ—Ç—Ä–∏–∫–∏ –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã

---

## üéâ –ì–æ—Ç–æ–≤–æ!

**–ú–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å –ø–æ–ª–Ω–æ—Å—Ç—å—é —Ä–∞–∑–≤—ë—Ä–Ω—É—Ç –∏ —Ä–∞–±–æ—Ç–∞–µ—Ç –Ω–∞ AWS Lambda!**

–í—Å–µ endpoints –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω—ã –∏ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∏—Ä—É—é—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ. –°–µ—Ä–≤–∏—Å –≥–æ—Ç–æ–≤ –∫ production –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é.

**–°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏:**
1. –ù–∞—Å—Ç—Ä–æ–π—Ç–µ Tilda webhook
2. –î–æ–±–∞–≤—å—Ç–µ JavaScript —Ç—Ä–µ–∫–∏–Ω–≥ –Ω–∞ —Å–∞–π—Ç—ã
3. –ú–æ–Ω–∏—Ç–æ—Ä—å—Ç–µ –º–µ—Ç—Ä–∏–∫–∏ –≤ CloudWatch
4. –ù–∞—Å—Ç—Ä–æ–π—Ç–µ CloudWatch –∞–ª–µ—Ä—Ç—ã (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

---

## üìö –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

- **DEPLOYMENT_SUCCESS.md** - —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –¥–µ–ø–ª–æ—è
- **DEPLOYED.md** - –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Ä–∞–∑–≤—ë—Ä–Ω—É—Ç–æ–º —Å–µ—Ä–≤–∏—Å–µ
- **DEPLOYMENT.md** - –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø–æ –¥–µ–ø–ª–æ—é
- **ENV_INFO.md** - –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è
- **README.md** - –æ–±—â–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
- **docs/ARCHITECTURE.md** - –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞
- **docs/API.md** - API –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

---

**–í–µ—Ä—Å–∏—è:** 2.0.0  
**–°—Ç–∞—Ç—É—Å:** ‚úÖ Production Ready  
**–†–µ–≥–∏–æ–Ω:** eu-central-1 (Frankfurt)  
**Endpoints:** ‚úÖ –í—Å–µ —Ä–∞–±–æ—Ç–∞—é—Ç


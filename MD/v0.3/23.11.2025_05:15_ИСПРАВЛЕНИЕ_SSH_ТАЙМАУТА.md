# üîß –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ SSH —Ç–∞–π–º–∞—É—Ç–∞ –ø—Ä–∏ –¥–µ–ø–ª–æ–µ

**–î–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è:** 23.11.2025 05:15  
**–°—Ç–∞—Ç—É—Å:** ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ

---

## ‚ùå –ü—Ä–æ–±–ª–µ–º–∞

```
Connection timed out during banner exchange
Connection to *** port 22 timed out
scp: Connection closed
Error: Process completed with exit code 255.
```

**–ü—Ä–∏—á–∏–Ω–∞:** –ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω—ã–π —Ç–∞–π–º–∞—É—Ç –¥–ª—è SSH –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∏–ª–∏ –ø—Ä–æ–±–ª–µ–º—ã —Å —Å–µ—Ç—å—é.

---

## ‚úÖ –†–µ—à–µ–Ω–∏–µ

### 1. –£–≤–µ–ª–∏—á–µ–Ω—ã —Ç–∞–π–º–∞—É—Ç—ã

**–ë—ã–ª–æ:**
```bash
-o ConnectTimeout=30
```

**–°—Ç–∞–ª–æ:**
```bash
-o ConnectTimeout=60
```

### 2. –î–æ–±–∞–≤–ª–µ–Ω—ã ServerAlive –æ–ø—Ü–∏–∏

```bash
-o ServerAliveInterval=30    # –û—Ç–ø—Ä–∞–≤–ª—è—Ç—å keepalive –∫–∞–∂–¥—ã–µ 30 —Å–µ–∫—É–Ω–¥
-o ServerAliveCountMax=3     # –ú–∞–∫—Å–∏–º—É–º 3 –ø–æ–ø—ã—Ç–∫–∏ –ø–µ—Ä–µ–¥ —Ä–∞–∑—Ä—ã–≤–æ–º
```

**–ß—Ç–æ —ç—Ç–æ –¥–µ–ª–∞–µ—Ç:**
- –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ –∞–∫—Ç–∏–≤–Ω—ã–º –≤–æ –≤—Ä–µ–º—è –¥–ª–∏—Ç–µ–ª—å–Ω—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π
- –ü—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞–µ—Ç —Ç–∞–π–º–∞—É—Ç—ã –∏–∑-–∑–∞ –Ω–µ–∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–µ—Ä–µ–ø–æ–¥–∫–ª—é—á–∞–µ—Ç—Å—è –ø—Ä–∏ –ø—Ä–æ–±–ª–µ–º–∞—Ö

### 3. –î–æ–±–∞–≤–ª–µ–Ω–∞ retry –ª–æ–≥–∏–∫–∞ –¥–ª—è SCP

```bash
MAX_RETRIES=3
RETRY_COUNT=0
while [ $RETRY_COUNT -lt $MAX_RETRIES ]; do
  if scp ...; then
    echo "‚úÖ Package uploaded successfully"
    break
  else
    RETRY_COUNT=$((RETRY_COUNT + 1))
    if [ $RETRY_COUNT -lt $MAX_RETRIES ]; then
      echo "‚ö†Ô∏è –ó–∞–≥—Ä—É–∑–∫–∞ –Ω–µ —É–¥–∞–ª–∞—Å—å, –ø–æ–≤—Ç–æ—Ä —á–µ—Ä–µ–∑ 10 —Å–µ–∫—É–Ω–¥..."
      sleep 10
    fi
  fi
done
```

**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:**
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –ø–æ–≤—Ç–æ—Ä—ã –ø—Ä–∏ –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö —Å–±–æ—è—Ö —Å–µ—Ç–∏
- –£–≤–µ–ª–∏—á–∏–≤–∞–µ—Ç —à–∞–Ω—Å—ã —É—Å–ø–µ—à–Ω–æ–π –∑–∞–≥—Ä—É–∑–∫–∏
- –õ–æ–≥–∏—Ä—É–µ—Ç –∫–∞–∂–¥—É—é –ø–æ–ø—ã—Ç–∫—É

### 4. –î–æ–±–∞–≤–ª–µ–Ω—ã –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ SSH –æ–ø—Ü–∏–∏

```bash
-o BatchMode=yes              # –ù–µ –∑–∞–ø—Ä–∞—à–∏–≤–∞—Ç—å –ø–∞—Ä–æ–ª—å (—Ç–æ–ª—å–∫–æ –∫–ª—é—á)
-o UserKnownHostsFile=/dev/null  # –ù–µ —Å–æ—Ö—Ä–∞–Ω—è—Ç—å known_hosts
```

---

## üìã –ß—Ç–æ –∏–∑–º–µ–Ω–µ–Ω–æ

### –í—Å–µ SSH –∫–æ–º–∞–Ω–¥—ã —Ç–µ–ø–µ—Ä—å –∏—Å–ø–æ–ª—å–∑—É—é—Ç:

```bash
ssh -o StrictHostKeyChecking=no \
    -o ConnectTimeout=60 \
    -o ServerAliveInterval=30 \
    -o ServerAliveCountMax=3 \
    -o BatchMode=yes \
    -o UserKnownHostsFile=/dev/null \
    ${{ env.VPS_USER }}@${{ env.VPS_HOST }}
```

### SCP —Å retry –ª–æ–≥–∏–∫–æ–π:

```bash
MAX_RETRIES=3
RETRY_COUNT=0
while [ $RETRY_COUNT -lt $MAX_RETRIES ]; do
  if scp -o ConnectTimeout=60 \
         -o ServerAliveInterval=30 \
         -o ServerAliveCountMax=3 \
         ...; then
    break
  else
    RETRY_COUNT=$((RETRY_COUNT + 1))
    sleep 10
  fi
done
```

---

## üß™ –¢–µ—Å—Ç

–¢–µ–ø–µ—Ä—å workflow –¥–æ–ª–∂–µ–Ω —Ä–∞–±–æ—Ç–∞—Ç—å —Å—Ç–∞–±–∏–ª—å–Ω–µ–µ:

1. –û—Ç–∫—Ä–æ–π: https://github.com/aoneagency001-maker/lead-generation-system/actions
2. –ó–∞–ø—É—Å—Ç–∏ workflow: **"Run workflow"** ‚Üí **"Run workflow"**
3. –ü—Ä–æ–≤–µ—Ä—å –ª–æ–≥–∏:
   - ‚úÖ SCP –¥–æ–ª–∂–µ–Ω –ø–æ–≤—Ç–æ—Ä–∏—Ç—å –ø–æ–ø—ã—Ç–∫—É –ø—Ä–∏ —Ç–∞–π–º–∞—É—Ç–µ
   - ‚úÖ SSH —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å —Å—Ç–∞–±–∏–ª—å–Ω–µ–µ
   - ‚úÖ –ù–µ—Ç —Ç–∞–π–º–∞—É—Ç–æ–≤ –∏–∑-–∑–∞ –Ω–µ–∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏

---

## üìã –í–æ–∑–º–æ–∂–Ω—ã–µ –ø—Ä–∏—á–∏–Ω—ã —Ç–∞–π–º–∞—É—Ç–æ–≤

–ï—Å–ª–∏ –ø—Ä–æ–±–ª–µ–º–∞ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è, –ø—Ä–æ–≤–µ—Ä—å:

1. **–ü—Ä–∞–≤–∏–ª—å–Ω–æ—Å—Ç—å IP –∞–¥—Ä–µ—Å–∞:**
   ```bash
   ping 13.220.11.94
   ```

2. **–î–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å –ø–æ—Ä—Ç–∞ 22:**
   ```bash
   telnet 13.220.11.94 22
   # –∏–ª–∏
   nc -zv 13.220.11.94 22
   ```

3. **–ü—Ä–∞–≤–∏–ª—å–Ω–æ—Å—Ç—å SSH –∫–ª—é—á–∞:**
   ```bash
   ssh -i ~/.ssh/github_actions_deploy ec2-user@13.220.11.94
   ```

4. **–§–∞–π—Ä–≤–æ–ª –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ:**
   ```bash
   ssh ec2-user@13.220.11.94
   sudo iptables -L -n
   ```

5. **Security Groups –≤ AWS:**
   - –ü—Ä–æ–≤–µ—Ä—å, —á—Ç–æ –ø–æ—Ä—Ç 22 –æ—Ç–∫—Ä—ã—Ç –¥–ª—è GitHub Actions IP
   - –ò–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–π 0.0.0.0/0 (–º–µ–Ω–µ–µ –±–µ–∑–æ–ø–∞—Å–Ω–æ)

---

## ‚úÖ –ò—Ç–æ–≥–æ–≤—ã–π —Å—Ç–∞—Ç—É—Å

- [x] –£–≤–µ–ª–∏—á–µ–Ω—ã —Ç–∞–π–º–∞—É—Ç—ã (30 ‚Üí 60 —Å–µ–∫—É–Ω–¥)
- [x] –î–æ–±–∞–≤–ª–µ–Ω—ã ServerAlive –æ–ø—Ü–∏–∏
- [x] –î–æ–±–∞–≤–ª–µ–Ω–∞ retry –ª–æ–≥–∏–∫–∞ –¥–ª—è SCP
- [x] –î–æ–±–∞–≤–ª–µ–Ω—ã –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ SSH –æ–ø—Ü–∏–∏
- [ ] Workflow –∑–∞–ø—É—â–µ–Ω –∏ –ø—Ä–æ—à—ë–ª —É—Å–ø–µ—à–Ω–æ

---

**–î–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è:** 23.11.2025 05:15  
**–°—Ç–∞—Ç—É—Å:** ‚úÖ **–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ!**


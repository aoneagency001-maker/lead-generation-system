# üîç –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ SSH –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ AWS EC2

**–î–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è:** 23.11.2025 05:25  
**–°—Ç–∞—Ç—É—Å:** üîç –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞

---

## üìä –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –ø—Ä–æ–≤–µ—Ä–∫–∏

### ‚úÖ –ß—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç:

1. **–ü–æ—Ä—Ç 22 –æ—Ç–∫—Ä—ã—Ç:**
   ```
   Connection to 13.220.11.94 port 22 [tcp/ssh] succeeded!
   ```

2. **–ö–ª—é—á –Ω–∞–π–¥–µ–Ω:**
   ```
   ~/.ssh/leadgen-system-key.pem (–ø—Ä–∞–≤–∞: 400)
   ```

3. **GitHub Secrets –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã:**
   - `VPS_HOST` = `13.220.11.94` ‚úÖ
   - `VPS_USER` = `ec2-user` ‚úÖ
   - `VPS_SSH_KEY` = –Ω–∞—Å—Ç—Ä–æ–µ–Ω ‚úÖ

### ‚ö†Ô∏è –ü—Ä–æ–±–ª–µ–º–∞:

**SSH –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∑–∞–≤–∏—Å–∞–µ—Ç –Ω–∞ —ç—Ç–∞–ø–µ "banner exchange":**

```
debug1: Connection established.
Connection timed out during banner exchange
Connection to 13.220.11.94 port 22 timed out
```

**–ß—Ç–æ —ç—Ç–æ –∑–Ω–∞—á–∏—Ç:**
- TCP —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è —É—Å–ø–µ—à–Ω–æ
- –ù–æ SSH —Å–µ—Ä–≤–µ—Ä –Ω–µ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç banner (–ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ)
- –í–æ–∑–º–æ–∂–Ω—ã–µ –ø—Ä–∏—á–∏–Ω—ã:
  1. SSH —Å–µ—Ä–≤–∏—Å –º–µ–¥–ª–µ–Ω–Ω–æ –æ—Ç–≤–µ—á–∞–µ—Ç
  2. –ü—Ä–æ–±–ª–µ–º—ã —Å —Å–µ—Ç—å—é –º–µ–∂–¥—É –∫–ª–∏–µ–Ω—Ç–æ–º –∏ —Å–µ—Ä–≤–µ—Ä–æ–º
  3. Security Group –∏–ª–∏ —Ñ–∞–π—Ä–≤–æ–ª –±–ª–æ–∫–∏—Ä—É–µ—Ç SSH —Ç—Ä–∞—Ñ–∏–∫ —á–∞—Å—Ç–∏—á–Ω–æ
  4. –°–µ—Ä–≤–µ—Ä –ø–µ—Ä–µ–≥—Ä—É–∂–µ–Ω

---

## üîß –†–µ—à–µ–Ω–∏—è

### –†–µ—à–µ–Ω–∏–µ 1: –£–≤–µ–ª–∏—á–∏—Ç—å —Ç–∞–π–º–∞—É—Ç—ã (—É–∂–µ —Å–¥–µ–ª–∞–Ω–æ –≤ workflow)

```bash
ssh -i ~/.ssh/leadgen-system-key.pem \
    -o ConnectTimeout=60 \
    -o ServerAliveInterval=30 \
    -o ServerAliveCountMax=3 \
    -o TCPKeepAlive=yes \
    ec2-user@13.220.11.94
```

### –†–µ—à–µ–Ω–∏–µ 2: –ü—Ä–æ–≤–µ—Ä–∏—Ç—å SSH —Å–µ—Ä–≤–∏—Å –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ

**–ï—Å–ª–∏ –µ—Å—Ç—å –¥–æ—Å—Ç—É–ø —á–µ—Ä–µ–∑ AWS Systems Manager Session Manager:**

1. –ó–∞–π–¥–∏ –≤ AWS Console ‚Üí EC2 ‚Üí Instances
2. –í—ã–±–µ—Ä–∏ –∏–Ω—Å—Ç–∞–Ω—Å `i-0fd42f4b1d227227e`
3. –ù–∞–∂–º–∏ "Connect" ‚Üí "Session Manager"
4. –ü—Ä–æ–≤–µ—Ä—å SSH —Å–µ—Ä–≤–∏—Å:
   ```bash
   sudo systemctl status sshd
   sudo systemctl restart sshd
   ```

### –†–µ—à–µ–Ω–∏–µ 3: –ü—Ä–æ–≤–µ—Ä–∏—Ç—å Security Groups

**–í AWS Console:**

1. EC2 ‚Üí Instances ‚Üí –≤—ã–±–µ—Ä–∏ –∏–Ω—Å—Ç–∞–Ω—Å
2. Security ‚Üí Security groups
3. Inbound rules ‚Üí –ø—Ä–æ–≤–µ—Ä—å –ø—Ä–∞–≤–∏–ª–æ –¥–ª—è SSH:
   - Type: SSH
   - Port: 22
   - Source: 0.0.0.0/0 (–∏–ª–∏ —Ç–≤–æ–π IP)
   - Protocol: TCP

### –†–µ—à–µ–Ω–∏–µ 4: –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ñ–∞–π—Ä–≤–æ–ª –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ

**–ß–µ—Ä–µ–∑ Session Manager:**

```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å iptables
sudo iptables -L -n

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å firewalld (–µ—Å–ª–∏ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω)
sudo systemctl status firewalld
```

---

## üìã –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –¥–ª—è GitHub Actions

### Workflow —É–∂–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω —Å:

1. ‚úÖ –£–≤–µ–ª–∏—á–µ–Ω–Ω—ã–º–∏ —Ç–∞–π–º–∞—É—Ç–∞–º–∏ (60 —Å–µ–∫—É–Ω–¥)
2. ‚úÖ ServerAlive –æ–ø—Ü–∏—è–º–∏
3. ‚úÖ Retry –ª–æ–≥–∏–∫–æ–π –¥–ª—è SCP
4. ‚úÖ BatchMode –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏

### –ï—Å–ª–∏ –ø—Ä–æ–±–ª–µ–º–∞ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è:

1. **–ü—Ä–æ–≤–µ—Ä—å Security Groups:**
   - –î–æ–ª–∂–µ–Ω –±—ã—Ç—å –æ—Ç–∫—Ä—ã—Ç –ø–æ—Ä—Ç 22 –¥–ª—è GitHub Actions IP
   - –ò–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–π 0.0.0.0/0 (–º–µ–Ω–µ–µ –±–µ–∑–æ–ø–∞—Å–Ω–æ)

2. **–ü—Ä–æ–≤–µ—Ä—å —Å—Ç–∞—Ç—É—Å –∏–Ω—Å—Ç–∞–Ω—Å–∞:**
   - –î–æ–ª–∂–µ–Ω –±—ã—Ç—å "running"
   - –ü—Ä–æ–≤–µ—Ä—å CPU/Memory usage

3. **–ü–æ–ø—Ä–æ–±—É–π –ø–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å –∏–Ω—Å—Ç–∞–Ω—Å:**
   - AWS Console ‚Üí EC2 ‚Üí Instances
   - –í—ã–±–µ—Ä–∏ –∏–Ω—Å—Ç–∞–Ω—Å ‚Üí Actions ‚Üí Instance State ‚Üí Reboot

---

## üß™ –¢–µ—Å—Ç –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è

### –ö–æ–º–∞–Ω–¥–∞ –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏:

```bash
ssh -i ~/.ssh/leadgen-system-key.pem \
    -o ConnectTimeout=60 \
    -o ServerAliveInterval=10 \
    -o ServerAliveCountMax=6 \
    -o TCPKeepAlive=yes \
    -v \
    ec2-user@13.220.11.94
```

### –û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:

```
‚úÖ –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ —Ä–∞–±–æ—Ç–∞–µ—Ç!
ec2-user
ip-172-31-75-196.ec2.internal
/home/ec2-user
```

---

## üìù –ò—Ç–æ–≥–æ–≤–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è

### –î–∞–Ω–Ω—ã–µ —Å–µ—Ä–≤–µ—Ä–∞:

- **IP:** `13.220.11.94`
- **User:** `ec2-user`
- **Instance ID:** `i-0fd42f4b1d227227e`
- **Key:** `~/.ssh/leadgen-system-key.pem`
- **–ü–æ—Ä—Ç 22:** ‚úÖ –û—Ç–∫—Ä—ã—Ç
- **SSH –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ:** ‚ö†Ô∏è –¢–∞–π–º–∞—É—Ç –Ω–∞ banner exchange

### –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏:

1. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å SSH —Å–µ—Ä–≤–∏—Å —á–µ—Ä–µ–∑ Session Manager
2. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å Security Groups –≤ AWS
3. –ü–æ–ø—Ä–æ–±–æ–≤–∞—Ç—å –ø–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å –∏–Ω—Å—Ç–∞–Ω—Å
4. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏ SSH –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ

---

**–î–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è:** 23.11.2025 05:25  
**–°—Ç–∞—Ç—É—Å:** üîç **–¢—Ä–µ–±—É–µ—Ç—Å—è –ø—Ä–æ–≤–µ—Ä–∫–∞ SSH —Å–µ—Ä–≤–∏—Å–∞ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ**


# ‚úÖ –î–µ–ø–ª–æ–π Telegram Notifications Service –Ω–∞ AWS –∑–∞–≤–µ—Ä—à—ë–Ω

**–î–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è:** 21.11.2025 05:15  
**–°—Ç–∞—Ç—É—Å:** ‚úÖ –£—Å–ø–µ—à–Ω–æ —Ä–∞–∑–≤—ë—Ä–Ω—É—Ç–æ –Ω–∞ AWS Lambda

---

## üéØ –ß—Ç–æ –±—ã–ª–æ —Å–¥–µ–ª–∞–Ω–æ

1. ‚úÖ **–ù–∞—Å—Ç—Ä–æ–µ–Ω—ã AWS credentials** - –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ AWS –∞–∫–∫–∞—É–Ω—Ç—É
2. ‚úÖ **–ü–æ–ª—É—á–µ–Ω Chat ID** - —á–µ—Ä–µ–∑ Telegram Bot API (280192618)
3. ‚úÖ **–°–æ—Ö—Ä–∞–Ω–µ–Ω—ã —Å–µ–∫—Ä–µ—Ç—ã –≤ SSM** - BOT_TOKEN –∏ CHAT_ID
4. ‚úÖ **–ò—Å–ø—Ä–∞–≤–ª–µ–Ω—ã –æ—à–∏–±–∫–∏ –∫–æ–º–ø–∏–ª—è—Ü–∏–∏** - TypeScript –æ—à–∏–±–∫–∏ —É—Å—Ç—Ä–∞–Ω–µ–Ω—ã
5. ‚úÖ **–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è** - serverless.yml –ø—Ä–∏–≤–µ–¥—ë–Ω –∫ —Ä–∞–±–æ—á–µ–º—É —Å–æ—Å—Ç–æ—è–Ω–∏—é
6. ‚úÖ **–í—ã–ø–æ–ª–Ω–µ–Ω –¥–µ–ø–ª–æ–π** - –≤—Å–µ Lambda —Ñ—É–Ω–∫—Ü–∏–∏ —Ä–∞–∑–≤—ë—Ä–Ω—É—Ç—ã
7. ‚úÖ **–ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω—ã endpoints** - health check —Ä–∞–±–æ—Ç–∞–µ—Ç

---

## üåê –†–∞–∑–≤—ë—Ä–Ω—É—Ç—ã–µ endpoints

**Base URL:** `https://cppf0omfz6.execute-api.eu-central-1.amazonaws.com`

### –î–æ—Å—Ç—É–ø–Ω—ã–µ endpoints:

1. **POST** `/track-visitor` - –û—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –ø–æ—Å–µ—Ç–∏—Ç–µ–ª–µ–π
2. **POST** `/tilda-webhook` - –û–±—Ä–∞–±–æ—Ç–∫–∞ –∑–∞—è–≤–æ–∫ —Å Tilda
3. **POST** `/metrika-webhook` - –°–æ–±—ã—Ç–∏—è –∏–∑ –Ø–Ω–¥–µ–∫—Å.–ú–µ—Ç—Ä–∏–∫–∏
4. **GET** `/health` - Health check

---

## üîê –ù–∞—Å—Ç—Ä–æ–µ–Ω–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã

### AWS Systems Manager Parameter Store

‚úÖ `/telegram-notifications/BOT_TOKEN`  
‚úÖ `/telegram-notifications/CHAT_ID` (280192618)

### AWS Resources

‚úÖ **4 Lambda —Ñ—É–Ω–∫—Ü–∏–∏:**
- `telegram-notifications-service-dev-trackVisitor`
- `telegram-notifications-service-dev-tildaWebhook`
- `telegram-notifications-service-dev-metrikaWebhook`
- `telegram-notifications-service-dev-health`

‚úÖ **API Gateway HTTP API** - —Å–æ–∑–¥–∞–Ω –∏ –Ω–∞—Å—Ç—Ä–æ–µ–Ω

‚úÖ **DynamoDB —Ç–∞–±–ª–∏—Ü–∞** - `telegram-notifications-events-dev`

‚úÖ **CloudWatch Logs** - –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã

‚úÖ **CloudWatch Metrics** - –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –æ—Ç–ø—Ä–∞–≤–∫–∞ –º–µ—Ç—Ä–∏–∫

---

## üß™ –†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

### Health Check

```bash
curl https://cppf0omfz6.execute-api.eu-central-1.amazonaws.com/health
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç

### Track Visitor

```bash
curl -X POST https://cppf0omfz6.execute-api.eu-central-1.amazonaws.com/track-visitor \
  -H "Content-Type: application/json" \
  -d '{"clientId":"test_client","page":"/test"}'
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç, —Å–æ–±—ã—Ç–∏—è —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ DynamoDB

---

## üìä –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

### CloudWatch Logs

–í—Å–µ –ª–æ–≥–∏ –¥–æ—Å—Ç—É–ø–Ω—ã –≤:
- `/aws/lambda/telegram-notifications-service-dev-trackVisitor`
- `/aws/lambda/telegram-notifications-service-dev-tildaWebhook`
- `/aws/lambda/telegram-notifications-service-dev-metrikaWebhook`
- `/aws/lambda/telegram-notifications-service-dev-health`

### CloudWatch Metrics

Namespace: `TelegramNotifications/dev`

–î–æ—Å—Ç—É–ø–Ω—ã–µ –º–µ—Ç—Ä–∏–∫–∏:
- `visit_events` - –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–æ–±—ã—Ç–∏–π –≤–∏–∑–∏—Ç–æ–≤
- `form_events` - –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞—è–≤–æ–∫
- `metrika_events` - —Å–æ–±—ã—Ç–∏—è –∏–∑ –ú–µ—Ç—Ä–∏–∫–∏
- `telegram_notifications` - –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
- `errors` - –æ—à–∏–±–∫–∏ –ø–æ —Ç–∏–ø–∞–º
- `*_duration` - –¥–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è

---

## üîó –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è

### Tilda Webhook

**URL –¥–ª—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –≤ Tilda:**
```
https://cppf0omfz6.execute-api.eu-central-1.amazonaws.com/tilda-webhook
```

**–ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è:**
1. Tilda ‚Üí –ù–∞—Å—Ç—Ä–æ–π–∫–∏ —Ñ–æ—Ä–º—ã ‚Üí –û—Ç–ø—Ä–∞–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö
2. –í—ã–±–µ—Ä–∏—Ç–µ "Webhook"
3. –í—Å—Ç–∞–≤—å—Ç–µ URL –≤—ã—à–µ
4. –ú–µ—Ç–æ–¥: POST
5. Content-Type: application/json

### JavaScript —Ç—Ä–µ–∫–∏–Ω–≥ –Ω–∞ —Å–∞–π—Ç–µ

```javascript
// –î–æ–±–∞–≤—å—Ç–µ –Ω–∞ —Å–∞–π—Ç
fetch('https://cppf0omfz6.execute-api.eu-central-1.amazonaws.com/track-visitor', {
  method: 'POST',
  headers: { 'Content-Type': 'application/json' },
  body: JSON.stringify({
    clientId: 'your_client_id',
    page: window.location.pathname,
    referrer: document.referrer,
    screenResolution: `${screen.width}x${screen.height}`,
    sessionId: getSessionId(),
    utmSource: new URLSearchParams(window.location.search).get('utm_source'),
    utmMedium: new URLSearchParams(window.location.search).get('utm_medium'),
  }),
}).catch(() => {});
```

---

## üìù –°–æ–∑–¥–∞–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã

### –°–∫—Ä–∏–ø—Ç—ã

- `scripts/setup-aws.js` - –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ SSM –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤
- `scripts/get-chat-id.js` - –ø–æ–ª—É—á–µ–Ω–∏–µ Chat ID
- `scripts/deploy.sh` - —Å–∫—Ä–∏–ø—Ç –¥–ª—è –¥–µ–ø–ª–æ—è

### –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

- `.env.production` - –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –¥–ª—è production (–Ω–µ —Å–æ–∑–¥–∞–Ω, –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω .gitignore)
- `.env.development` - –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –¥–ª—è development (–Ω–µ —Å–æ–∑–¥–∞–Ω, –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω .gitignore)

**–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ:** .env —Ñ–∞–π–ª—ã –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω—ã .gitignore –¥–ª—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏.  
–í—Å–µ —Å–µ–∫—Ä–µ—Ç—ã —Ö—Ä–∞–Ω—è—Ç—Å—è –≤ AWS SSM Parameter Store.

---

## üîÑ –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ

–î–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –∫–æ–¥–∞ –ø–æ—Å–ª–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π:

```bash
cd telegram-notifications-service
npm run build
export AWS_ACCESS_KEY_ID=your_aws_access_key_id
export AWS_SECRET_ACCESS_KEY=your_aws_secret_access_key
export AWS_REGION=eu-central-1
npm run deploy:dev
```

---

## üóë –£–¥–∞–ª–µ–Ω–∏–µ (–µ—Å–ª–∏ –Ω—É–∂–Ω–æ)

```bash
cd telegram-notifications-service
export AWS_ACCESS_KEY_ID=your_aws_access_key_id
export AWS_SECRET_ACCESS_KEY=your_aws_secret_access_key
export AWS_REGION=eu-central-1
serverless remove --stage dev
```

‚ö†Ô∏è **–í–Ω–∏–º–∞–Ω–∏–µ:** –≠—Ç–æ —É–¥–∞–ª–∏—Ç –≤—Å–µ —Ä–µ—Å—É—Ä—Å—ã (Lambda, API Gateway, DynamoDB —Ç–∞–±–ª–∏—Ü—É).

---

## ‚úÖ –ß–µ–∫–ª–∏—Å—Ç

- [x] AWS credentials –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã
- [x] Chat ID –ø–æ–ª—É—á–µ–Ω (280192618)
- [x] –°–µ–∫—Ä–µ—Ç—ã —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã –≤ SSM
- [x] –ü—Ä–æ–µ–∫—Ç —Å–æ–±—Ä–∞–Ω (npm run build)
- [x] –î–µ–ø–ª–æ–π –≤—ã–ø–æ–ª–Ω–µ–Ω —É—Å–ø–µ—à–Ω–æ
- [x] Health check —Ä–∞–±–æ—Ç–∞–µ—Ç
- [x] Endpoints –¥–æ—Å—Ç—É–ø–Ω—ã
- [x] DynamoDB —Ç–∞–±–ª–∏—Ü–∞ —Å–æ–∑–¥–∞–Ω–∞
- [x] CloudWatch –ª–æ–≥–∏ —Ä–∞–±–æ—Ç–∞—é—Ç
- [x] CloudWatch –º–µ—Ç—Ä–∏–∫–∏ –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã

---

## üéâ –ì–æ—Ç–æ–≤–æ!

–ú–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å —É—Å–ø–µ—à–Ω–æ —Ä–∞–∑–≤—ë—Ä–Ω—É—Ç –Ω–∞ AWS Lambda –∏ –≥–æ—Ç–æ–≤ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é!

**–°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏:**
1. –ù–∞—Å—Ç—Ä–æ–π—Ç–µ Tilda webhook
2. –î–æ–±–∞–≤—å—Ç–µ JavaScript —Ç—Ä–µ–∫–∏–Ω–≥ –Ω–∞ —Å–∞–π—Ç—ã
3. –ù–∞—Å—Ç—Ä–æ–π—Ç–µ CloudWatch –∞–ª–µ—Ä—Ç—ã (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
4. –ú–æ–Ω–∏—Ç–æ—Ä—å—Ç–µ –º–µ—Ç—Ä–∏–∫–∏ –≤ CloudWatch

---

## üìö –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

- **DEPLOYED.md** - –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Ä–∞–∑–≤—ë—Ä–Ω—É—Ç–æ–º —Å–µ—Ä–≤–∏—Å–µ
- **DEPLOYMENT.md** - –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø–æ –¥–µ–ø–ª–æ—é
- **README.md** - –æ–±—â–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
- **docs/ARCHITECTURE.md** - –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞
- **docs/API.md** - API –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

---

**–í–µ—Ä—Å–∏—è:** 2.0.0  
**–°—Ç–∞—Ç—É—Å:** ‚úÖ Production Ready  
**–†–µ–≥–∏–æ–Ω:** eu-central-1 (Frankfurt)

